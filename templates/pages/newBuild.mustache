<h2 class="title"><a href="/jobs/{{job.name}}">{{job.name}}</a> &gt;&gt; New build</h2>
<br><br>

<pre id="buildResult"></pre>


<script>
$(function () {
  var buildResultUrl = "/jobs/{{job.name}}/builds/{{job.nextBuildNumber}}"
    , $buildResult = $('#buildResult')
    , buildStarted = false
    ;

  function checkBuildStatus () {
    $.ajax({ url: buildResultUrl })
     .done(function (data, textStatus, jqXHR) {
        console.log("-------------");

       if (jqXHR.status === 201) {
         $buildResult.html(data.message);
         setTimeout(checkBuildStatus, 2000);
       } else {
         $buildResult.html(data.log);
         setTimeout(checkBuildStatus, 500);
       }
     })
     .fail(function (jqXHR) {
       console.log("=== Failed");
       if (buildStarted) {
         console.log("=== Build finished executing");
       } else {
         console.log("=== No fucking build scheduled");
       }
       /*setTimeout(checkBuildStatus, 2000);*/
       /*window.location = '/jobs/{{job.name}}';*/
     });
  }

  checkBuildStatus();
});
</script>
